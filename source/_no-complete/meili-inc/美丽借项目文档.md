# 公共
首页：
index.html
1.user_channel接口查看用户渠道，跳转到对应的渠道上

## 分期乐

分期乐首页：
fql_index.html
1.fql_home接口获取用户授权信息，用来确定用户是否已授信，未授信展示授信页

a.未授信
2.点击查看额度
未实名用户需要先进行实名
未授信：
点击查看额度，进行授信，展示授信。用户未注册分期乐，点击授信时会先进行分期乐注册fql_register_silence，注册成功后
fql_credit_apply接口授信

b.已授信进入借款状态
显示借款信息


借款页：
1.fql_loan_info获取借款信息最高可借金额

2.card_listbind获取已绑定银行卡列表

3.借款流程：
fql_loan_sendsms接口发送短信验证码，携带借款金额，用途。返回订单号。
fql_loan_confirm确认借款接口，发送短信验证码，订单号进行借款。



一、贷前
进入“我的”，点击“美丽金融”进入我的钱包页面。点击“美丽借”调用user_channel接口，获取用户渠道或者是否为白流量用户。
A.分期乐
1.fql_home
调用fql_home接口，该接口无入参。通过session获取userId，返回用户授信状态homeData.creditStatus。若未授信，则展示“查看额度”页面，若已授信，则展示“我要借款”页面。若为未授信，则看HomeFenqileVo.doesOpen,为false，则调用fql_register_silence注册分期乐，成功后再调用fql_credit_apply接口进行授信 ；HomeFenqileVo.doesOpen为true则直接调用授信接口fql_credit_apply。

2.fql_register_silence
注册分期乐，并将分期乐返回的dsUserId存入MeiLiLoanChannelUserInfo表。

3.fql_credit_apply
授信申请接口。授信前在该接口中会自动生成账单日。而后调用授信中心接口进行授信。


B.自营

二、贷中
A.分期乐
点击“我要借款”，判断fql_home接口中获取HomeFenqileVo.doesOpen.doesContacts为false时，进入联系人新增页面；为true时进入借款申请页面。
1.fql_contacts_insert
联系人新增接口，调用分期乐接口，插入联系人信息，若成功，则调用lrm接口将联系人信息存入授信中心。然后跳转尽快申请页面。
2.fql_loan_info
获取用户相关授信信息，并填充至申请页面中。
3.card_listbind
点击“提现至”选择银行卡，调用该接口，判断蘑菇街绑定卡列表是否已在分期乐绑定。
4.fql_loan_sendsms
选择分期乐未绑定的银行卡，点击发送短信，调用该接口。
5.card_confirmbind
输入6位验证码后，调用该接口，验证是否通过。
6.fql_card_ocrstatus
点击“去借款”，若没有上传身份证，则跳出弹出，点击“去上传”，调用该接口，获取用户基本信息。
7.fql_card_upload
点击上传栏，选择图片后调用该接口，后端调用分期乐接口进行上传，返回调用状态和验证状态。
8.fql_loan_fee
借款申请页面，选择完分期期数后，调用该接口，获取月供及还款计划
9.card_listbind
点击“提现至”，调用该接口拉去绑卡列表
10.fql_loan_sendsms
点击“去借款”，弹出页面，点击发送短信，调用该接口。
11.fql_loan_confirm
输入6位验证码后，调用该接口进行校验。
12.loan_result(不分渠道)
查看账单信息

B.自营

三、贷后

点“立即还款”调用还款repayment_result接口。


## 过程梳理


一、贷前
进入“我的”，点击“美丽金融”进入我的钱包页面。点击“美丽借”调用user_channel接口，获取用户渠道或者是否为白流量用户。
A.分期乐
1.fql_home
调用fql_home接口，该接口无入参。通过session获取userId，返回用户授信状态homeData.creditStatus。若未授信，则展示“查看额度”页面，若已授信，则展示“我要借款”页面。若为未授信，则看HomeFenqileVo.doesOpen,为false，则调用fql_register_silence注册分期乐，成功后再调用fql_credit_apply接口进行授信 ；HomeFenqileVo.doesOpen为true则直接调用授信接口fql_credit_apply。

2.fql_register_silence
注册分期乐，并将分期乐返回的dsUserId存入MeiLiLoanChannelUserInfo表。

3.fql_credit_apply
授信申请接口。授信前在该接口中会自动生成账单日。而后调用授信中心接口进行授信。


B.自营

二、贷中
A.分期乐
点击“我要借款”，判断fql_home接口中获取HomeFenqileVo.doesOpen.doesContacts为false时，进入联系人新增页面；为true时进入借款申请页面。
1.fql_contacts_insert
联系人新增接口，调用分期乐接口，插入联系人信息，若成功，则调用lrm接口将联系人信息存入授信中心。然后跳转尽快申请页面。
2.fql_loan_info
获取用户相关授信信息，并填充至申请页面中。
3.card_listbind
点击“提现至”选择银行卡，调用该接口，判断蘑菇街绑定卡列表是否已在分期乐绑定。
4.fql_loan_sendsms
选择分期乐未绑定的银行卡，点击发送短信，调用该接口。
5.card_confirmbind
输入6位验证码后，调用该接口，验证是否通过。
6.fql_card_ocrstatus
点击“去借款”，若没有上传身份证，则跳出弹出，点击“去上传”，调用该接口，获取用户基本信息。
7.fql_card_upload
点击上传栏，选择图片后调用该接口，后端调用分期乐接口进行上传，返回调用状态和验证状态。
8.fql_loan_fee
借款申请页面，选择完分期期数后，调用该接口，获取月供及还款计划
9.card_listbind
点击“提现至”，调用该接口拉去绑卡列表
10.fql_loan_sendsms
点击“去借款”，弹出页面，点击发送短信，调用该接口。
11.fql_loan_confirm
输入6位验证码后，调用该接口进行校验。
12.loan_result(不分渠道)
查看账单信息



B.自营

三、贷后

点“立即还款”调用还款repayment_result接口。

