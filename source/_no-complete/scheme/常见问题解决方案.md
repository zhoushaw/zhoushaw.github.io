# 上传附件


```javascript
<input ref='img_click_ob' type="file" class="upload_file" @change="imagePreview"/>

  import * as qiniu from 'qiniu-js'
  
 async imagePreview(e) {
        const file = e.target.files[0];
        if (!file) {
          return;
        }

        // 获取token
        const qiniuTokenData = await getQiniuToken();
        let baseUrl = qiniuTokenData.data.url;

        // 将文件格式转换，并转换成对应的blob类型
        let formData = new FormData();
        formData.append('file',file)
        let type = '';
        let regPdf = /\.pdf$/;
        let regExcel = /(\.xls)|(\.xlsx)$/;
        let regWord = /(\.doc)|(\.docx)$/;
        let regPpt = /\.ppt$/;

        if(regExcel.test(file.name)){
          type = "application/vnd.ms-excel";
        }else if(regPdf.test(file.name)){
          type = "application/pdf";
        }else if(regWord.test(file.name)){
          type = "application/word";
        }else if(regPpt.test(file.name)){
          type = "application/ppt";
        }else{
          this.$message({
            message: '请选择pdf、xls、word、ppt等格式文件',
            type: 'warning'
          })
          return;
        }
        formData = new Blob([file], {type: type});
        console.log(type);

        // 定义上传参数
        let putExtra = {
          fname: file.name,
          params: {},
          mimeType: null
        };

        this.$message({
          type: 'warning',
          message: '开始上传'
        })

        // 开始上传
        let observable = qiniu.upload(formData, file.name, qiniuTokenData.data.token, putExtra, {
          useCdnDomain: false,
          region: null
        })


        // 上传时间监听
        observable.subscribe({
          next(res){
            console.log(res);
          },
          error:(err)=>{
            this.$message({
              type: 'warning',
              message: '文件已存在'
            })
          },
          complete:(res)=>{
            let tag = `<a style="color:blue;text-decoration:underline;" href="${baseUrl+res.key}">${file.name}</a>`
            console.log(baseUrl+res.key)
            this.editorContent = this.editorContent+tag;
            this.$message({
              type: 'success',
              message: '上传成功'
            })
          }
        })
      }
    },

```
# 如果要让flex中最后的子元素靠右

margin-left:auto;


